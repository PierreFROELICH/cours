USE TEST;
GO
CREATE SCHEMA BRETAGNE;
GO
CREATE TABLE BRETAGNE.AGENCE(
age_id INTEGER NOT NULL PRIMARY KEY,
AGE_NOM VARCHAR(60),
AGE_ADRESSE VARCHAR(200),
AGE_TELEPHONE VARCHAR(20),
AGE_FAX VARCHAR(20),
AGE_MAIL VARCHAR(100)
)
;
INSERT INTO BRETAGNE.AGENCE VALUES(
1, 'Nantes', '9 rue du commandant Cousteau','','','');



CREATE TABLE BRETAGNE.VEHICULE(
veh_id INTEGER NOT NULL PRIMARY KEY,
veh_immat VARCHAR(20),
veh_agence INTEGER FOREIGN KEY REFERENCES BRETAGNE.AGENCE(age_id)
);


INSERT INTO BRETAGNE.VEHICULE VALUES(1, 'BC-095-LA',1) ;
INSERT INTO BRETAGNE.VEHICULE VALUES(2, 'EZ-786-WL',1) ;
INSERT INTO BRETAGNE.VEHICULE VALUES(3, 'ET-565-XQ',1) ;
INSERT INTO BRETAGNE.VEHICULE VALUES(4, 'CD-158-BS',1) ;
INSERT INTO BRETAGNE.VEHICULE VALUES(5, 'AF-982-VR',1) ;
INSERT INTO BRETAGNE.VEHICULE VALUES(6, 'PA-823-AM',1) ;


CREATE TABLE BRETAGNE.SALARIE(
sal_id INTEGER NOT NULL PRIMARY KEY,
sal_nom VARCHAR(30) ,
sal_prenom VARCHAR(30) ,
sal_dateNaissance DATE ,
dal_dateEmbauche DATE,
sal_adresse VARCHAR(200),
sal_agence INTEGER FOREIGN KEY REFERENCES BRETAGNE.AGENCE(age_id),
sal_type CHAR(1),
sal_permis VARCHAR(30),
sal_chef BIT,
sal_experience INTEGER
)
;

INSERT INTO BRETAGNE.SALARIE VALUES(
1, 'Durand','Hervé','12/06/1977','14/01/2012','',1,'D','C1',0,4);
INSERT INTO BRETAGNE.SALARIE VALUES(
2, 'Dubois','Aline','12/03/1982','14/07/2014','',1,'D','B',0,2);
INSERT INTO BRETAGNE.SALARIE VALUES(
3, 'Jaraf','Mohammed','12/05/1975','11/01/1999','',1,'D','CE',1,17);
INSERT INTO BRETAGNE.SALARIE VALUES(
4, 'Rampon','Fabrice','07/01/1980','14/02/2010','',1,'D','B',0,6);
INSERT INTO BRETAGNE.SALARIE VALUES(
5, 'Boss','Petit','07/03/1982','27/02/2011','',1,'C','B',0,5);
INSERT INTO BRETAGNE.SALARIE VALUES(
6, 'Genet','Midou','12/07/1982','14/09/2007','',1,'D','B',0,9);
INSERT INTO BRETAGNE.SALARIE VALUES(
7, 'Damido','Valérie','12/05/1975','11/11/2001','',1,'D','C',1,15);
INSERT INTO BRETAGNE.SALARIE VALUES(
8, 'Alfonso','Fidel','02/07/1966','02/11/1992','',1,'D','CE',0,24);
INSERT INTO BRETAGNE.SALARIE VALUES(
9, 'Bendjebbour','Azzid','02/05/1969','11/11/2009','',1,'D','B',1,7);
INSERT INTO BRETAGNE.SALARIE VALUES(
10, 'Benichou','Jean Marc','02/08/1979','11/01/2012','',1,'D','CE',1,4);


CREATE TABLE BRETAGNE.MOTIF_CONGE(
mot_id integer NOT NULL PRIMARY KEY,
mot_libelle VARCHAR(200)
);

INSERT INTO BRETAGNE.MOTIF_CONGE VALUES(1,'Vacances') ;
INSERT INTO BRETAGNE.MOTIF_CONGE VALUES(2,'RTT') ;
INSERT INTO BRETAGNE.MOTIF_CONGE VALUES(3,'Naissance') ;
INSERT INTO BRETAGNE.MOTIF_CONGE VALUES(4,'Sans solde') ;



CREATE TABLE BRETAGNE.CONGE(
con_id integer NOT NULL PRIMARY KEY,
con_dateDebut DATE,
con_dateFin DATE,
con_dateDemande DATE,
con_etatDemande VARCHAR(30),
con_dateReponse DATE,
con_salarie INTEGER FOREIGN KEY REFERENCES BRETAGNE.SALARIE(sal_id),
con_motif INTEGER FOREIGN KEY REFERENCES BRETAGNE.MOTIF_CONGE(mot_id)
);

INSERT INTO BRETAGNE.CONGE VALUES(1,'14/08/2016','21/08/2016','12/05/2016','Validé','30/05/2016',1,1) ;
INSERT INTO BRETAGNE.CONGE VALUES(2,'17/08/2016','21/08/2016','12/06/2016','Validé','15/06/2016',3,1) ;



CREATE TABLE BRETAGNE.DOSSIER_DEMENAGEMENT(
dos_numero integer NOT NULL PRIMARY KEY,
dos_dateOuverture DATE,
dos_dateDebutDem DATE,
dos_dateFinDem DATE,
dos_volume DECIMAL(10,2),
dos_nombreKm INTEGER,
dos_adresseChargement VARCHAR(200),
dos_adresseLivraison VARCHAR(200),
dos_etatDossier VARCHAR(30),
dos_nbDemenageurs INTEGER,
dos_dateCloture DATE,
dos_commercial INTEGER FOREIGN KEY REFERENCES BRETAGNE.SALARIE(sal_id),
dos_chefEquipe INTEGER FOREIGN KEY REFERENCES BRETAGNE.SALARIE(sal_id),
dos_agence INTEGER FOREIGN KEY REFERENCES BRETAGNE.AGENCE(age_id)
);

INSERT INTO BRETAGNE.DOSSIER_DEMENAGEMENT VALUES(
1,'10/05/2016', '12/05/2016', '13/05/2016', 23.5, 550, 'Cannes', 'Croisette',
'Validé',3, '16/05/2016',5,3,1) ;
INSERT INTO BRETAGNE.DOSSIER_DEMENAGEMENT VALUES(
2,'10/09/2016', '14/09/2016', '14/09/2016', 15, 50, 'Champigny', 'Place de église',
'Validé',2, '16/09/2016',5,7,1) ;
INSERT INTO BRETAGNE.DOSSIER_DEMENAGEMENT VALUES(
3,'12/07/2016', '14/07/2016', '16/07/2016', 16, 20, 'Creteil', 'rue du Parc',
'Validé',2, '20/07/2016',5,3,1) ;
INSERT INTO BRETAGNE.DOSSIER_DEMENAGEMENT VALUES(
4,'12/09/2016', '14/09/2016', '16/09/2016', 14, 45, 'Fontainebleau', 'Chateau',
'Validé',3, '20/09/2016',5,9,1) ;

CREATE TABLE BRETAGNE.UTILISER(
uti_dossier INTEGER NOT NULL FOREIGN KEY REFERENCES BRETAGNE.DOSSIER_DEMENAGEMENT(dos_numero) ,
uti_vehicule INTEGER NOT NULL FOREIGN KEY REFERENCES BRETAGNE.VEHICULE(veh_id),
CONSTRAINT clef_utiliser PRIMARY KEY (uti_dossier,uti_vehicule)
);

INSERT INTO BRETAGNE.UTILISER VALUES(1,1) ;
INSERT INTO BRETAGNE.UTILISER VALUES(1,2) ;
INSERT INTO BRETAGNE.UTILISER VALUES(2,3) ;
INSERT INTO BRETAGNE.UTILISER VALUES(3,1) ;
INSERT INTO BRETAGNE.UTILISER VALUES(3,5) ;
INSERT INTO BRETAGNE.UTILISER VALUES(4,1) ;

CREATE TABLE BRETAGNE.PARTICIPER(
par_dossier INTEGER NOT NULL FOREIGN KEY REFERENCES BRETAGNE.DOSSIER_DEMENAGEMENT(dos_numero) ,
par_demenageur INTEGER NOT NULL FOREIGN KEY REFERENCES BRETAGNE.SALARIE(sal_id),
CONSTRAINT clef_participer PRIMARY KEY (par_dossier,par_demenageur)
);

INSERT INTO BRETAGNE.PARTICIPER VALUES(1,1) ;
INSERT INTO BRETAGNE.PARTICIPER VALUES(1,2) ;
INSERT INTO BRETAGNE.PARTICIPER VALUES(1,3) ;
INSERT INTO BRETAGNE.PARTICIPER VALUES(2,6) ;
INSERT INTO BRETAGNE.PARTICIPER VALUES(2,7) ;
INSERT INTO BRETAGNE.PARTICIPER VALUES(4,8) ;
INSERT INTO BRETAGNE.PARTICIPER VALUES(4,9) ;
INSERT INTO BRETAGNE.PARTICIPER VALUES(4,10) ;



